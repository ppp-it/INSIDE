Injection a dll into application using an import table. An example.

При загрузке inside.dll создает меню и связывает пункты меню с обработчиками событий.

Чтобы интегрировать inside.dll в приложение test.exe нужни изменить таблицу импорта tet.exe.
Для этого любым HEX-редактором нужно открыть test.exe, найти запись USER32.DLL  заменить на 
INSIDE.DLL. В итоге при запуске text.exe загрузит INSIDE.DLL, которая загрузит USER32.DLL
(на основании таблицы импорта в INSIDE.DLL).

В длл определен класс - CMFCWinApp, нужно определить таблицу сообщений (MESSAGE_MAP) 
для этого класса. Далее элементы этой таблицы сообщений будут добавлены к обработчикам 
таблицы сообщений из исполняемого файла.

INSIDE.def сформирован для w2K16, и, возможно, потребуется изменение списка импорта.